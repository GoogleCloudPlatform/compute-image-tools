{
  "Name": "linux-image-test",
  "TestParallelCount": 10,
  "Tests": {
    {{$images := split .images "," -}}
    {{$length := len $images -}}
    {{range $index, $image := $images -}}
      {{$machine_types := mkSlice "f1-micro" "g1-small" "n1-standard-4" "n1-highmem-64" -}}
      {{range $machine_type := $machine_types -}}
        "test-boot-{{$machine_type}} [{{$image}}]": {
          "Path": "./boot/boot.wf.json",
          "Vars": {
              "source_image": "{{$image}}",
              "machine_type": "{{$machine_type}}"
          }
        },
      {{end -}}
      "test-metadata-ssh [{{$image}}]": {
        "Path": "./metadata-ssh/metadata-ssh.wf.json",
        "Vars": {
          "source_image": "{{$image}}"
        },
        "ProjectLock": true
      },
      "test-oslogin-ssh [{{$image}}]": {
        "Path": "./oslogin-ssh/oslogin-ssh.wf.json",
        "Vars": {
          "source_image": "{{$image}}"
        },
        "ProjectLock": true
      },
      "test-configuration [{{$image}}]": {
        "Path": "./configuration/configuration.wf.json",
        "Vars": {
          "source_image": "{{$image}}"
        }
      },
      "test-disk [{{$image}}]": {
        "Path": "./disk/disk.wf.json",
        "Vars": {
          "source_image": "{{$image}}"
        }
      }{{if lt (add $index 1) $length}},{{end}}
    {{end -}}
  }
}
